import { z } from "zod";

export const FileDiagnosticsResponse = z.object({ "start_index": z.number().int(), "max_items": z.union([z.number().int(), z.null()]).default(null), "total": z.union([z.number().int(), z.null()]).default(null), "has_more": z.boolean().default(false), "pagination_id": z.union([z.string(), z.null()]).default(null), "file_path": z.string(), "diagnostics": z.array(z.object({ "range": z.object({ "start": z.object({ "line": z.number().int().gte(1), "character": z.number().int().gte(1) }).describe("Represents a specific position in a file using line and character numbers.\n\nNote: Line and character are 1-based indices. 0-based indices are used in LSP, so conversion is needed when interfacing with LSP."), "end": z.object({ "line": z.number().int().gte(1), "character": z.number().int().gte(1) }).describe("Represents a specific position in a file using line and character numbers.\n\nNote: Line and character are 1-based indices. 0-based indices are used in LSP, so conversion is needed when interfacing with LSP.") }), "severity": z.enum(["Error","Warning","Information","Hint"]), "message": z.string(), "source": z.union([z.string(), z.null()]).default(null), "code": z.union([z.string(), z.number().int(), z.null()]).default(null) })) });

export const FileDiagnosticsResponseTemplates = {
  "markdown": "\n# Diagnostics for `{{ file_path }}`\n{% if total != nil -%}\nTotal issues: {{ total }} | Showing: {{ diagnostics.size }}{% if max_items != nil %} (Offset: {{ start_index }}, Limit: {{ max_items }}){% endif %}\n{%- endif %}\n\n{% if diagnostics.size == 0 -%}\nNo issues found.\n{%- else -%}\n| Line:Col | Severity | Message |\n| :--- | :--- | :--- |\n{%- for d in diagnostics %}\n| {{ d.range.start.line }}:{{ d.range.start.character }} | {{ d.severity }} | {{ d.message }} |\n{%- endfor %}\n\n{% if has_more -%}\n---\n> [!TIP]\n> More issues available.\n{%- if pagination_id != nil %}\n> Use `pagination_id=\"{{ pagination_id }}\"` to fetch the next page.\n{%- else %}\n> To see the rest, specify a `max_items` and use: `start_index={% assign step = max_items | default: diagnostics.size %}{{ start_index | plus: step }}`\n{%- endif %}\n{%- endif %}\n{%- endif %}\n"
} as const;
